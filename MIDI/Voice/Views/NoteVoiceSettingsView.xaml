<UserControl x:Class="MIDI.Voice.Views.NoteVoiceSettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="clr-namespace:MIDI.Voice.ViewModels"
             xmlns:models="clr-namespace:MIDI.Voice.Models"
             xmlns:viewModels="clr-namespace:MIDI.UI.ViewModels.Models;assembly=MIDI"
             xmlns:c="clr-namespace:YukkuriMovieMaker.Controls;assembly=YukkuriMovieMaker.Controls"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:local="clr-namespace:MIDI.Voice.Views"
             xmlns:conv="clr-namespace:MIDI.Voice.Views.Converters"
             xmlns:midi="clr-namespace:MIDI"
             xmlns:prim="clr-namespace:System.Windows.Controls.Primitives;assembly=PresentationFramework"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type=vm:NoteVoiceSettingsViewModel}"
             d:DesignHeight="700"
             d:DesignWidth="800"
             Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
             Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
             SizeChanged="NoteVoiceSettingsView_SizeChanged">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/MIDI;component/UI/Views/MidiEditor/Resources/MidiEditorResources.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <conv:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <conv:EnumToBooleanConverter x:Key="EnumToBooleanConverter" />
            <conv:ModelTypeToBooleanConverter x:Key="ModelTypeToBooleanConverter" />
            <conv:InverseBooleanConverter x:Key="InverseBooleanConverter" />
            <conv:PathToImageSourceConverter x:Key="PathToImageSourceConverter" />

            <DataTemplate x:Key="UtauVoiceComboBoxSelectionTemplate"
                          DataType="{x:Type vm:UtauVoiceViewModel}">
                <StackPanel Orientation="Horizontal">
                    <Image Source="{Binding ImagePath, Converter={StaticResource PathToImageSourceConverter}}"
                           Stretch="Uniform"
                           Width="20"
                           Height="20"
                           VerticalAlignment="Center"
                           Margin="0,0,5,0" />
                    <TextBlock Text="{Binding Name}"
                               VerticalAlignment="Center"
                               TextTrimming="CharacterEllipsis" />
                </StackPanel>
            </DataTemplate>

            <DataTemplate x:Key="UtauVoiceDataTemplate"
                          DataType="{x:Type vm:UtauVoiceViewModel}">
                <Border Padding="5"
                        Margin="0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="64" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Border Width="60"
                                Height="60"
                                BorderBrush="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"
                                BorderThickness="1"
                                VerticalAlignment="Top"
                                HorizontalAlignment="Left"
                                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
                            <Image Source="{Binding ImagePath, Converter={StaticResource PathToImageSourceConverter}}"
                                   Stretch="Uniform" />
                        </Border>
                        <StackPanel Grid.Column="1"
                                    Margin="10,0,0,0">
                            <TextBlock Text="{Binding Name}"
                                       FontWeight="Bold"
                                       FontSize="16"
                                       TextTrimming="CharacterEllipsis" />
                            <TextBlock Text="{Binding DisplayInfo}"
                                       FontSize="12"
                                       TextWrapping="Wrap"
                                       Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                        </StackPanel>
                    </Grid>
                </Border>
            </DataTemplate>

            <Style x:Key="UtauVoiceComboBoxStyle"
                   TargetType="{x:Type ComboBox}"
                   BasedOn="{StaticResource {x:Type ComboBox}}">
                <Setter Property="ItemTemplate"
                        Value="{StaticResource UtauVoiceDataTemplate}" />
                <Setter Property="ItemContainerStyle">
                    <Setter.Value>
                        <Style TargetType="ComboBoxItem"
                               BasedOn="{StaticResource {x:Type ComboBoxItem}}">
                            <Setter Property="HorizontalContentAlignment"
                                    Value="Stretch" />
                        </Style>
                    </Setter.Value>
                </Setter>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ComboBox}">
                            <Grid x:Name="templateRoot"
                                  SnapsToDevicePixels="true">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition MinWidth="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"
                                                      Width="0" />
                                </Grid.ColumnDefinitions>
                                <Popup x:Name="PART_Popup"
                                       AllowsTransparency="true"
                                       Grid.ColumnSpan="2"
                                       IsOpen="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                       Margin="1"
                                       PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}"
                                       Placement="Bottom">
                                    <Border x:Name="dropDownBorder"
                                            BorderBrush="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"
                                            BorderThickness="1"
                                            Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                            MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                            MinWidth="{Binding ActualWidth, ElementName=templateRoot}">
                                        <ScrollViewer x:Name="DropDownScrollViewer">
                                            <Grid x:Name="grid"
                                                  RenderOptions.ClearTypeHint="Enabled">
                                                <Canvas x:Name="canvas"
                                                        HorizontalAlignment="Left"
                                                        Height="0"
                                                        VerticalAlignment="Top"
                                                        Width="0">
                                                    <Rectangle x:Name="opaqueRect"
                                                               Fill="{Binding Background, ElementName=dropDownBorder}"
                                                               Height="{Binding ActualHeight, ElementName=dropDownBorder}"
                                                               Width="{Binding ActualWidth, ElementName=dropDownBorder}" />
                                                </Canvas>
                                                <ItemsPresenter x:Name="ItemsPresenter"
                                                                KeyboardNavigation.DirectionalNavigation="Contained"
                                                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                            </Grid>
                                        </ScrollViewer>
                                    </Border>
                                </Popup>
                                <prim:ToggleButton x:Name="toggleButton"
                                                   BorderBrush="{TemplateBinding BorderBrush}"
                                                   BorderThickness="{TemplateBinding BorderThickness}"
                                                   Background="{TemplateBinding Background}"
                                                   Grid.ColumnSpan="2"
                                                   IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                   Style="{StaticResource {x:Type ToggleButton}}" />
                                <ContentPresenter x:Name="contentPresenter"
                                                  ContentTemplate="{StaticResource UtauVoiceComboBoxSelectionTemplate}"
                                                  Content="{TemplateBinding SelectionBoxItem}"
                                                  ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  IsHitTestVisible="false"
                                                  Margin="{TemplateBinding Padding}"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="HasItems"
                                         Value="false">
                                    <Setter Property="Height"
                                            TargetName="dropDownBorder"
                                            Value="95" />
                                </Trigger>
                                <Trigger Property="IsEnabled"
                                         Value="false">
                                    <Setter Property="Opacity"
                                            TargetName="templateRoot"
                                            Value="0.56" />
                                </Trigger>
                                <Trigger Property="IsMouseOver"
                                         Value="true">
                                    <Setter Property="BorderBrush"
                                            TargetName="toggleButton"
                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsKeyboardFocused"
                                         Value="true">
                                    <Setter Property="BorderBrush"
                                            TargetName="toggleButton"
                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="RichButtonStyle"
                   TargetType="Button">
                <Setter Property="Background"
                        Value="Transparent" />
                <Setter Property="Foreground"
                        Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderBrush"
                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                <Setter Property="BorderThickness"
                        Value="1" />
                <Setter Property="Padding"
                        Value="12,6" />
                <Setter Property="HorizontalContentAlignment"
                        Value="Center" />
                <Setter Property="VerticalContentAlignment"
                        Value="Center" />
                <Setter Property="Height"
                        Value="32" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    SnapsToDevicePixels="true">
                                <ContentPresenter x:Name="contentPresenter"
                                                  Focusable="False"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  Margin="{TemplateBinding Padding}"
                                                  RecognizesAccessKey="True"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver"
                                         Value="True">
                                    <Setter TargetName="border"
                                            Property="BorderBrush"
                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsPressed"
                                         Value="True">
                                    <Setter TargetName="border"
                                            Property="Background"
                                            Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsEnabled"
                                         Value="False">
                                    <Setter TargetName="border"
                                            Property="Opacity"
                                            Value="0.56" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="CompactButtonStyle"
                   TargetType="Button"
                   BasedOn="{StaticResource RichButtonStyle}">
                <Setter Property="Padding"
                        Value="6" />
                <Setter Property="Height"
                        Value="32" />
            </Style>

            <Style x:Key="HamburgerToggleButtonStyle"
                   TargetType="ToggleButton">
                <Setter Property="Background"
                        Value="Transparent" />
                <Setter Property="BorderBrush"
                        Value="Transparent" />
                <Setter Property="BorderThickness"
                        Value="1" />
                <Setter Property="Padding"
                        Value="6" />
                <Setter Property="HorizontalContentAlignment"
                        Value="Center" />
                <Setter Property="VerticalContentAlignment"
                        Value="Center" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ToggleButton">
                            <Border x:Name="border"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    SnapsToDevicePixels="true">
                                <ContentPresenter x:Name="contentPresenter"
                                                  Focusable="False"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  Margin="{TemplateBinding Padding}"
                                                  RecognizesAccessKey="True"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver"
                                         Value="True">
                                    <Setter TargetName="border"
                                            Property="BorderBrush"
                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsChecked"
                                         Value="True">
                                    <Setter TargetName="border"
                                            Property="Background"
                                            Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsEnabled"
                                         Value="False">
                                    <Setter TargetName="border"
                                            Property="Opacity"
                                            Value="0.56" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="IconPathStyle"
                   TargetType="Path">
                <Setter Property="Fill"
                        Value="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type ButtonBase}}}" />
                <Setter Property="Width"
                        Value="16" />
                <Setter Property="Height"
                        Value="16" />
                <Setter Property="Stretch"
                        Value="Uniform" />
                <Setter Property="HorizontalAlignment"
                        Value="Center" />
                <Setter Property="VerticalAlignment"
                        Value="Center" />
            </Style>

            <Style x:Key="ResponsiveTabControlStyle"
                   TargetType="TabControl">
                <Setter Property="Background"
                        Value="Transparent" />
                <Setter Property="BorderThickness"
                        Value="0" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabControl">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <TabPanel x:Name="HeaderPanel"
                                          Grid.Row="0"
                                          IsItemsHost="true"
                                          Background="Transparent" />
                                <Border x:Name="ContentPanel"
                                        Grid.Row="1"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        Background="{TemplateBinding Background}">
                                    <ContentPresenter x:Name="PART_SelectedContentHost"
                                                      ContentSource="SelectedContent"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                </Border>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style TargetType="TabItem">
                <Setter Property="Padding"
                        Value="12,6" />
                <Setter Property="Foreground"
                        Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabItem">
                            <Border x:Name="Border"
                                    BorderThickness="0,0,0,2"
                                    BorderBrush="Transparent"
                                    Background="Transparent"
                                    Margin="0,0,10,0">
                                <ContentPresenter x:Name="ContentSite"
                                                  VerticalAlignment="Center"
                                                  HorizontalAlignment="Center"
                                                  ContentSource="Header"
                                                  Margin="{TemplateBinding Padding}">
                                    <ContentPresenter.Resources>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Foreground"
                                                    Value="{Binding RelativeSource={RelativeSource AncestorType=TabItem}, Path=Foreground}" />
                                        </Style>
                                    </ContentPresenter.Resources>
                                </ContentPresenter>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsSelected"
                                         Value="True">
                                    <Setter TargetName="Border"
                                            Property="BorderBrush"
                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                    <Setter Property="Foreground"
                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsMouseOver"
                                         Value="True">
                                    <Setter Property="Foreground"
                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style TargetType="Label"
                   x:Key="LabelStyle">
                <Setter Property="VerticalAlignment"
                        Value="Center" />
                <Setter Property="Margin"
                        Value="0,0,5,8" />
                <Setter Property="FontWeight"
                        Value="Normal" />
            </Style>

            <Style TargetType="TextBlock"
                   x:Key="HeaderTextBlockStyle">
                <Setter Property="FontWeight"
                        Value="Bold" />
                <Setter Property="Margin"
                        Value="0,0,0,10" />
            </Style>

            <Style TargetType="TextBox"
                   BasedOn="{StaticResource {x:Type TextBox}}">
                <Setter Property="VerticalContentAlignment"
                        Value="Center" />
                <Setter Property="Height"
                        Value="32" />
                <Setter Property="Padding"
                        Value="5,0" />
                <Setter Property="Background"
                        Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
                <Setter Property="BorderBrush"
                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                <Setter Property="Margin"
                        Value="5,0,0,8" />
            </Style>

            <Style TargetType="{x:Type c:TextBoxSlider}">
                <Setter Property="VerticalAlignment"
                        Value="Center" />
                <Setter Property="Margin"
                        Value="10,0,0,8" />
                <Setter Property="Height"
                        Value="32" />
                <Setter Property="Width"
                        Value="200" />
                <Setter Property="HorizontalAlignment"
                        Value="Left" />
            </Style>

            <Style TargetType="{x:Type ComboBox}"
                   BasedOn="{StaticResource {x:Type ComboBox}}">
                <Setter Property="VerticalContentAlignment"
                        Value="Center" />
                <Setter Property="Height"
                        Value="32" />
                <Setter Property="Margin"
                        Value="5,0,0,8" />
                <Setter Property="Padding"
                        Value="5,0" />
            </Style>

            <Style TargetType="CheckBox"
                   BasedOn="{StaticResource {x:Type CheckBox}}">
                <Setter Property="VerticalAlignment"
                        Value="Center" />
                <Setter Property="Margin"
                        Value="0,5" />
            </Style>

            <Style TargetType="RadioButton"
                   BasedOn="{StaticResource {x:Type RadioButton}}">
                <Setter Property="VerticalAlignment"
                        Value="Center" />
                <Setter Property="Margin"
                        Value="0,5" />
            </Style>

            <Style TargetType="ListBox"
                   BasedOn="{StaticResource {x:Type ListBox}}">
                <Setter Property="BorderBrush"
                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                <Setter Property="BorderThickness"
                        Value="1" />
                <Setter Property="Background"
                        Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
            </Style>

            <Style TargetType="ListBoxItem">
                <Setter Property="HorizontalContentAlignment"
                        Value="Stretch" />
                <Setter Property="Padding"
                        Value="5,5" />
                <Setter Property="FontSize"
                        Value="14" />
                <Setter Property="MinHeight"
                        Value="28" />
                <Setter Property="Background"
                        Value="Transparent" />
                <Setter Property="BorderThickness"
                        Value="1" />
                <Setter Property="BorderBrush"
                        Value="Transparent" />
                <Style.Triggers>
                    <Trigger Property="IsSelected"
                             Value="True">
                        <Setter Property="BorderBrush"
                                Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                        <Setter Property="Background"
                                Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                        <Setter Property="Foreground"
                                Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                    </Trigger>
                    <Trigger Property="IsMouseOver"
                             Value="True">
                        <Setter Property="BorderBrush"
                                Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                    </Trigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="IsSelected"
                                       Value="True" />
                            <Condition Property="IsFocused"
                                       Value="False" />
                        </MultiTrigger.Conditions>
                        <Setter Property="BorderBrush"
                                Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                        <Setter Property="Background"
                                Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                        <Setter Property="Foreground"
                                Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                    </MultiTrigger>
                </Style.Triggers>
            </Style>

            <Style x:Key="ScrollBarThumbStyle"
                   TargetType="{x:Type Thumb}">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Thumb}">
                            <Border x:Name="rectangle"
                                    SnapsToDevicePixels="True"
                                    Background="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"
                                    CornerRadius="3"
                                    Opacity="0.6" />
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver"
                                         Value="true">
                                    <Setter TargetName="rectangle"
                                            Property="Opacity"
                                            Value="0.8" />
                                </Trigger>
                                <Trigger Property="IsDragging"
                                         Value="true">
                                    <Setter TargetName="rectangle"
                                            Property="Opacity"
                                            Value="1" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style TargetType="{x:Type ScrollBar}">
                <Setter Property="Stylus.IsPressAndHoldEnabled"
                        Value="false" />
                <Setter Property="Stylus.IsFlicksEnabled"
                        Value="false" />
                <Setter Property="Foreground"
                        Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="Background"
                        Value="Transparent" />
                <Setter Property="Width"
                        Value="8" />
                <Setter Property="MinWidth"
                        Value="8" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ScrollBar}">
                            <Grid x:Name="Bg"
                                  SnapsToDevicePixels="true"
                                  Background="{TemplateBinding Background}">
                                <Track x:Name="PART_Track"
                                       IsDirectionReversed="true"
                                       IsEnabled="{TemplateBinding IsMouseOver}">
                                    <Track.Thumb>
                                        <Thumb Style="{DynamicResource ScrollBarThumbStyle}" />
                                    </Track.Thumb>
                                </Track>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="Orientation"
                             Value="Horizontal">
                        <Setter Property="Width"
                                Value="Auto" />
                        <Setter Property="MinWidth"
                                Value="0" />
                        <Setter Property="Height"
                                Value="8" />
                        <Setter Property="MinHeight"
                                Value="8" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type ScrollBar}">
                                    <Grid x:Name="Bg"
                                          SnapsToDevicePixels="true"
                                          Background="{TemplateBinding Background}">
                                        <Track x:Name="PART_Track"
                                               IsEnabled="{TemplateBinding IsMouseOver}">
                                            <Track.Thumb>
                                                <Thumb Style="{DynamicResource ScrollBarThumbStyle}" />
                                            </Track.Thumb>
                                        </Track>
                                    </Grid>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <Style x:Key="ExpanderHeaderFocusVisual">
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <Border>
                                <Rectangle Margin="0"
                                           SnapsToDevicePixels="true"
                                           Stroke="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"
                                           StrokeThickness="1"
                                           StrokeDashArray="1 2" />
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="ExpanderHeaderToggleButton"
                   TargetType="{x:Type ToggleButton}">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ToggleButton}">
                            <Border x:Name="border"
                                    Background="Transparent"
                                    Padding="{TemplateBinding Padding}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Path x:Name="Arrow"
                                          Grid.Column="0"
                                          Fill="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                          Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                          StrokeThickness="1"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Data="M 0 0 L 4 4 L 8 0 Z" />
                                    <ContentPresenter x:Name="ContentSite"
                                                      Grid.Column="1"
                                                      Margin="8,0,0,0"
                                                      RecognizesAccessKey="True"
                                                      SnapsToDevicePixels="True"
                                                      VerticalAlignment="Center" />
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsChecked"
                                         Value="True">
                                    <Setter TargetName="Arrow"
                                            Property="Data"
                                            Value="M 0 4 L 4 0 L 8 4 Z" />
                                </Trigger>
                                <Trigger Property="IsMouseOver"
                                         Value="True">
                                    <Setter TargetName="Arrow"
                                            Property="Fill"
                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                    <Setter TargetName="Arrow"
                                            Property="Stroke"
                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsPressed"
                                         Value="True">
                                    <Setter TargetName="Arrow"
                                            Property="Fill"
                                            Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                    <Setter TargetName="Arrow"
                                            Property="Stroke"
                                            Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsEnabled"
                                         Value="False">
                                    <Setter TargetName="Arrow"
                                            Property="Fill"
                                            Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    <Setter TargetName="Arrow"
                                            Property="Stroke"
                                            Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="ExpanderStyle"
                   TargetType="{x:Type Expander}">
                <Setter Property="Foreground"
                        Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="Background"
                        Value="Transparent" />
                <Setter Property="BorderBrush"
                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                <Setter Property="BorderThickness"
                        Value="1" />
                <Setter Property="Padding"
                        Value="4" />
                <Setter Property="Margin"
                        Value="0,5,0,5" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Expander}">
                            <Border BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Background="{TemplateBinding Background}"
                                    CornerRadius="0"
                                    SnapsToDevicePixels="true">
                                <DockPanel>
                                    <ToggleButton x:Name="HeaderSite"
                                                  DockPanel.Dock="Top"
                                                  Content="{TemplateBinding Header}"
                                                  ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                  ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}"
                                                  FontWeight="Bold"
                                                  FontSize="14"
                                                  Foreground="{TemplateBinding Foreground}"
                                                  HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  IsChecked="{Binding IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                  Margin="1"
                                                  MinWidth="0"
                                                  MinHeight="0"
                                                  Padding="8,6,8,6"
                                                  Style="{StaticResource ExpanderHeaderToggleButton}"
                                                  VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}" />
                                    <ContentPresenter x:Name="ExpandSite"
                                                      DockPanel.Dock="Bottom"
                                                      Focusable="false"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                      Margin="{TemplateBinding Padding}"
                                                      Visibility="Collapsed"
                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                                </DockPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsExpanded"
                                         Value="True">
                                    <Setter TargetName="ExpandSite"
                                            Property="Visibility"
                                            Value="Visible" />
                                </Trigger>
                                <Trigger Property="IsEnabled"
                                         Value="False">
                                    <Setter Property="Foreground"
                                            Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="GroupBoxStyle"
                   TargetType="{x:Type GroupBox}">
                <Setter Property="BorderBrush"
                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                <Setter Property="BorderThickness"
                        Value="1" />
                <Setter Property="Background"
                        Value="Transparent" />
                <Setter Property="Padding"
                        Value="10" />
                <Setter Property="Margin"
                        Value="0" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type GroupBox}">
                            <Grid SnapsToDevicePixels="true">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Border Grid.Row="0"
                                        BorderBrush="Transparent"
                                        BorderThickness="0"
                                        Background="Transparent"
                                        CornerRadius="0">
                                    <ContentPresenter ContentSource="Header"
                                                      RecognizesAccessKey="True"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                      Margin="0,0,0,5"
                                                      Visibility="{Binding Content, RelativeSource={RelativeSource Self}, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Border>
                                <Border Grid.Row="1"
                                        BorderBrush="Transparent"
                                        BorderThickness="0"
                                        Background="{TemplateBinding Background}"
                                        CornerRadius="0">
                                    <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                      Margin="{TemplateBinding Padding}" />
                                </Border>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

        </ResourceDictionary>
    </UserControl.Resources>

    <Grid x:Name="LayoutRoot"
          Margin="15">
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="WindowStates">
                <VisualState x:Name="Wide">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="HamburgerButton"
                                                       Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0"
                                                    Value="{x:Static Visibility.Collapsed}" />
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
                <VisualState x:Name="Compact">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="HamburgerButton"
                                                       Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0"
                                                    Value="{x:Static Visibility.Visible}" />
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>

            <VisualStateGroup x:Name="PanelStates">
                <VisualState x:Name="SideBySide">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ModelColumnLeft"
                                                       Storyboard.TargetProperty="Width">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <GridLength>250</GridLength>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ModelColumnRight"
                                                       Storyboard.TargetProperty="Width">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <GridLength>*</GridLength>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ModelRowBottom"
                                                       Storyboard.TargetProperty="Height">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <GridLength>*</GridLength>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>

                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RightPanel"
                                                       Storyboard.TargetProperty="(Grid.Row)">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <sys:Int32>0</sys:Int32>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RightPanel"
                                                       Storyboard.TargetProperty="(Grid.Column)">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <sys:Int32>1</sys:Int32>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RightPanel"
                                                       Storyboard.TargetProperty="(Grid.RowSpan)">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <sys:Int32>2</sys:Int32>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ThicknessAnimationUsingKeyFrames Storyboard.TargetName="RightPanel"
                                                          Storyboard.TargetProperty="Margin">
                            <DiscreteThicknessKeyFrame KeyTime="0"
                                                       Value="0,0,0,0" />
                        </ThicknessAnimationUsingKeyFrames>

                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LeftPanel"
                                                       Storyboard.TargetProperty="(Grid.ColumnSpan)">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <sys:Int32>1</sys:Int32>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ThicknessAnimationUsingKeyFrames Storyboard.TargetName="LeftPanel"
                                                          Storyboard.TargetProperty="Margin">
                            <DiscreteThicknessKeyFrame KeyTime="0"
                                                       Value="0,0,10,0" />
                        </ThicknessAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
                <VisualState x:Name="Stacked">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ModelColumnLeft"
                                                       Storyboard.TargetProperty="Width">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <GridLength>*</GridLength>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ModelColumnRight"
                                                       Storyboard.TargetProperty="Width">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <GridLength>0</GridLength>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ModelRowBottom"
                                                       Storyboard.TargetProperty="Height">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <GridLength>*</GridLength>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>

                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RightPanel"
                                                       Storyboard.TargetProperty="(Grid.Row)">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <sys:Int32>1</sys:Int32>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RightPanel"
                                                       Storyboard.TargetProperty="(Grid.Column)">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <sys:Int32>0</sys:Int32>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RightPanel"
                                                       Storyboard.TargetProperty="(Grid.RowSpan)">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <sys:Int32>1</sys:Int32>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ThicknessAnimationUsingKeyFrames Storyboard.TargetName="RightPanel"
                                                          Storyboard.TargetProperty="Margin">
                            <DiscreteThicknessKeyFrame KeyTime="0"
                                                       Value="0,10,0,0" />
                        </ThicknessAnimationUsingKeyFrames>

                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LeftPanel"
                                                       Storyboard.TargetProperty="(Grid.ColumnSpan)">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <sys:Int32>2</sys:Int32>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                        <ThicknessAnimationUsingKeyFrames Storyboard.TargetName="LeftPanel"
                                                          Storyboard.TargetProperty="Margin">
                            <DiscreteThicknessKeyFrame KeyTime="0"
                                                       Value="0,0,0,0" />
                        </ThicknessAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0"
                    Orientation="Horizontal"
                    Margin="0,0,0,10">
            <Label Content="{x:Static midi:Translate.NoteVoiceSettingsSampleRateLabel}"
                   Style="{StaticResource LabelStyle}"
                   VerticalAlignment="Center" />
            <ComboBox ItemsSource="{Binding SampleRateOptions}"
                      SelectedItem="{Binding SynthSettings.SampleRate}"
                      Style="{StaticResource {x:Type ComboBox}}"
                      Width="120"
                      VerticalAlignment="Center" />
        </StackPanel>

        <DockPanel Grid.Row="1">
            <ToggleButton x:Name="HamburgerButton"
                          Style="{StaticResource HamburgerToggleButtonStyle}"
                          DockPanel.Dock="Left"
                          VerticalAlignment="Top"
                          Visibility="Collapsed"
                          Width="32"
                          Height="32"
                          Margin="0,0,5,0">
                <Path Data="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"
                      Fill="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                      Stretch="Uniform"
                      Width="16"
                      Height="16" />
            </ToggleButton>

            <Popup x:Name="MenuPopup"
                   IsOpen="{Binding IsChecked, ElementName=HamburgerButton, Mode=TwoWay}"
                   StaysOpen="False"
                   Placement="Bottom"
                   PlacementTarget="{Binding ElementName=HamburgerButton}">
                <Border Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                        BorderBrush="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"
                        BorderThickness="1">
                    <ListBox x:Name="TabListBox"
                             ItemsSource="{Binding Items, ElementName=MainTabControl}"
                             SelectedItem="{Binding SelectedItem, ElementName=MainTabControl, Mode=TwoWay}"
                             SelectionChanged="TabListBox_SelectionChanged">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Header}"
                                           Margin="5" />
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Border>
            </Popup>

            <TabControl x:Name="MainTabControl"
                        Style="{StaticResource ResponsiveTabControlStyle}">
                <TabItem Header="{x:Static midi:Translate.NoteVoiceSettingsModelSelectionHeader}">
                    <Grid x:Name="ModelSelectionGrid"
                          Margin="0,10,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition x:Name="ModelColumnLeft"
                                              Width="250" />
                            <ColumnDefinition x:Name="ModelColumnRight"
                                              Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition x:Name="ModelRowTop"
                                           Height="Auto" />
                            <RowDefinition x:Name="ModelRowBottom"
                                           Height="*" />
                        </Grid.RowDefinitions>

                        <StackPanel x:Name="LeftPanel"
                                    Grid.Column="0"
                                    Grid.Row="0"
                                    Margin="0,0,10,0">
                            <TextBlock Text="{x:Static midi:Translate.NoteVoiceSettingsModelSelectionHeader}"
                                       Style="{StaticResource HeaderTextBlockStyle}" />
                            <ComboBox ItemsSource="{Binding VoiceModels}"
                                      SelectedItem="{Binding SelectedModel, Mode=TwoWay}"
                                      DisplayMemberPath="Name"
                                      Margin="0,0,0,5"
                                      Style="{StaticResource {x:Type ComboBox}}"
                                      VerticalAlignment="Center" />
                            <StackPanel Orientation="Horizontal"
                                        HorizontalAlignment="Right"
                                        Margin="0,0,0,10">
                                <Button Content="{x:Static midi:Translate.NoteVoiceSettingsNewButton}"
                                        Command="{Binding CreateNewModelCommand}"
                                        Style="{StaticResource RichButtonStyle}"
                                        Margin="0,0,5,0" />
                                <Button Content="{x:Static midi:Translate.NoteVoiceSettingsSaveButton}"
                                        Command="{Binding SaveCurrentModelCommand}"
                                        IsEnabled="{Binding CanSaveCurrentModel}"
                                        Style="{StaticResource RichButtonStyle}" />
                            </StackPanel>
                        </StackPanel>

                        <Border x:Name="RightPanel"
                                Grid.Column="1"
                                Grid.Row="0"
                                Grid.RowSpan="2"
                                BorderBrush="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"
                                BorderThickness="1"
                                Padding="10">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <StackPanel>

                                    <Expander Style="{StaticResource ExpanderStyle}"
                                              Header="{x:Static midi:Translate.NoteVoiceSettingsSoundFontLayerSettingsHeader}"
                                              IsExpanded="{Binding IsSoundFontSettingsExpanded, Mode=TwoWay}">
                                        <GroupBox Style="{StaticResource GroupBoxStyle}"
                                                  BorderThickness="0"
                                                  Padding="5"
                                                  IsEnabled="{Binding IsSoundFontModelSelected}">
                                            <Grid Margin="0,10,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0"
                                                            Grid.Row="0">
                                                    <WrapPanel Orientation="Horizontal"
                                                               Margin="0,0,0,10"
                                                               UseLayoutRounding="True">
                                                        <ComboBox ItemsSource="{Binding AvailableSoundFonts}"
                                                                  SelectedItem="{Binding SelectedAvailableSoundFont}"
                                                                  DisplayMemberPath="FileName"
                                                                  Style="{StaticResource {x:Type ComboBox}}"
                                                                  MinWidth="150"
                                                                  HorizontalAlignment="Left"
                                                                  VerticalAlignment="Center"
                                                                  Margin="0,0,5,0" />
                                                        <Button Content="{x:Static midi:Translate.NoteVoiceSettingsAddLayerButton}"
                                                                Command="{Binding AddLayerCommand}"
                                                                IsEnabled="{Binding CanAddLayer}"
                                                                Style="{StaticResource RichButtonStyle}"
                                                                Margin="0,0,5,0"
                                                                VerticalAlignment="Center" />
                                                        <Button Content="{x:Static midi:Translate.NoteVoiceSettingsBrowseAddButton}"
                                                                Command="{Binding BrowseSoundFontCommand}"
                                                                Style="{StaticResource RichButtonStyle}"
                                                                Margin="0,0,5,0"
                                                                VerticalAlignment="Center" />
                                                        <Button Command="{Binding RefreshFilesCommand}"
                                                                ToolTip="{x:Static midi:Translate.NoteVoiceSettingsUpdateFileListTooltip}"
                                                                Style="{StaticResource CompactButtonStyle}"
                                                                Margin="0,0,0,0"
                                                                VerticalAlignment="Center">
                                                            <Path Data="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"
                                                                  Style="{StaticResource IconPathStyle}" />
                                                        </Button>
                                                    </WrapPanel>
                                                    <ListBox ItemsSource="{Binding SoundFontLayers}"
                                                             SelectedItem="{Binding SelectedLayer}"
                                                             DisplayMemberPath="SoundFontFile"
                                                             MinHeight="150"
                                                             Style="{StaticResource {x:Type ListBox}}" />
                                                </StackPanel>
                                                <StackPanel Grid.Column="1"
                                                            VerticalAlignment="Center"
                                                            Margin="5,0,0,0">
                                                    <Button Command="{Binding MoveLayerUpCommand}"
                                                            IsEnabled="{Binding CanMoveLayerUp}"
                                                            Style="{StaticResource CompactButtonStyle}"
                                                            ToolTip="{x:Static midi:Translate.NoteVoiceSettingsMoveLayerUpTooltip}"
                                                            Margin="0,0,0,5">
                                                        <Path Width="10"
                                                              Height="10"
                                                              Stretch="Uniform"
                                                              Fill="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                                              Data="M0,5 L5,0 L10,5 Z" />
                                                    </Button>
                                                    <Button Command="{Binding MoveLayerDownCommand}"
                                                            IsEnabled="{Binding CanMoveLayerDown}"
                                                            Style="{StaticResource CompactButtonStyle}"
                                                            ToolTip="{x:Static midi:Translate.NoteVoiceSettingsMoveLayerDownTooltip}"
                                                            Margin="0,0,0,5">
                                                        <Path Width="10"
                                                              Height="10"
                                                              Stretch="Uniform"
                                                              Fill="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                                              Data="M0,0 L5,5 L10,0 Z" />
                                                    </Button>
                                                    <Button Command="{Binding RemoveLayerCommand}"
                                                            IsEnabled="{Binding CanRemoveLayer}"
                                                            Style="{StaticResource RichButtonStyle}"
                                                            ToolTip="{x:Static midi:Translate.NoteVoiceSettingsDeleteLayerTooltip}"
                                                            Margin="0,0,0,5">
                                                        <Path Width="13"
                                                              Height="13"
                                                              Stretch="Uniform"
                                                              Fill="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                                              Data="M9,3V4H4V6H5V19C5,20.1 5.9,21 7,21H17C18.1,21 19,20.1 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z" />
                                                    </Button>
                                                </StackPanel>
                                            </Grid>
                                        </GroupBox>
                                    </Expander>

                                    <Expander Style="{StaticResource ExpanderStyle}"
                                              Header="{x:Static midi:Translate.NoteVoiceSettingsInternalSynthSettingsHeader}"
                                              IsExpanded="{Binding IsInternalSynthSettingsExpanded, Mode=TwoWay}">
                                        <GroupBox Style="{StaticResource GroupBoxStyle}"
                                                  BorderThickness="0"
                                                  Padding="5"
                                                  IsEnabled="{Binding IsInternalSynthModelSelected}">
                                            <Grid DataContext="{Binding SelectedModel.InternalSynthSettings}"
                                                  Margin="0,10,0,0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"
                                                                      MinWidth="120" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>

                                                <Label Grid.Row="0"
                                                       Grid.Column="0"
                                                       Content="{x:Static midi:Translate.NoteVoiceSettingsDefaultWaveformLabel}"
                                                       Style="{StaticResource LabelStyle}"
                                                       ToolTip="{x:Static midi:Translate.NoteVoiceSettingsDefaultWaveformTooltip}" />
                                                <ComboBox Grid.Row="0"
                                                          Grid.Column="1"
                                                          ItemsSource="{Binding DataContext.WaveformOptions, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                          SelectedItem="{Binding DefaultWaveform}"
                                                          Style="{StaticResource {x:Type ComboBox}}" />

                                                <Label Grid.Row="1"
                                                       Grid.Column="0"
                                                       Content="{x:Static midi:Translate.NoteVoiceSettingsAttackLabel}"
                                                       Style="{StaticResource LabelStyle}"
                                                       ToolTip="{x:Static midi:Translate.NoteVoiceSettingsAttackTooltip}" />
                                                <c:TextBoxSlider Grid.Row="1"
                                                                 Grid.Column="1"
                                                                 Value="{Binding Attack}"
                                                                 Min="0.001"
                                                                 Max="2.0"
                                                                 StringFormat="F3"
                                                                 Style="{StaticResource {x:Type c:TextBoxSlider}}" />

                                                <Label Grid.Row="2"
                                                       Grid.Column="0"
                                                       Content="{x:Static midi:Translate.NoteVoiceSettingsDecayLabel}"
                                                       Style="{StaticResource LabelStyle}"
                                                       ToolTip="{x:Static midi:Translate.NoteVoiceSettingsDecayTooltip}" />
                                                <c:TextBoxSlider Grid.Row="2"
                                                                 Grid.Column="1"
                                                                 Value="{Binding Decay}"
                                                                 Min="0.0"
                                                                 Max="5.0"
                                                                 StringFormat="F3"
                                                                 Style="{StaticResource {x:Type c:TextBoxSlider}}" />

                                                <Label Grid.Row="3"
                                                       Grid.Column="0"
                                                       Content="{x:Static midi:Translate.NoteVoiceSettingsSustainLabel}"
                                                       Style="{StaticResource LabelStyle}"
                                                       ToolTip="{x:Static midi:Translate.NoteVoiceSettingsSustainTooltip}" />
                                                <c:TextBoxSlider Grid.Row="3"
                                                                 Grid.Column="1"
                                                                 Value="{Binding Sustain}"
                                                                 Min="0.0"
                                                                 Max="1.0"
                                                                 StringFormat="F2"
                                                                 Style="{StaticResource {x:Type c:TextBoxSlider}}" />

                                                <Label Grid.Row="4"
                                                       Grid.Column="0"
                                                       Content="{x:Static midi:Translate.NoteVoiceSettingsReleaseLabel}"
                                                       Style="{StaticResource LabelStyle}"
                                                       ToolTip="{x:Static midi:Translate.NoteVoiceSettingsReleaseTooltip}" />
                                                <c:TextBoxSlider Grid.Row="4"
                                                                 Grid.Column="1"
                                                                 Value="{Binding Release}"
                                                                 Min="0.001"
                                                                 Max="5.0"
                                                                 StringFormat="F3"
                                                                 Style="{StaticResource {x:Type c:TextBoxSlider}}" />

                                                <CheckBox Grid.Row="5"
                                                          Grid.Column="0"
                                                          Grid.ColumnSpan="2"
                                                          IsChecked="{Binding EnableBandlimited}"
                                                          Content="{x:Static midi:Translate.NoteVoiceSettingsBandlimitedSynthCheckbox}"
                                                          Style="{StaticResource {x:Type CheckBox}}"
                                                          ToolTip="{x:Static midi:Translate.NoteVoiceSettingsBandlimitedSynthTooltip}"
                                                          Margin="0,10,0,0" />
                                            </Grid>
                                        </GroupBox>
                                    </Expander>

                                    <Expander Style="{StaticResource ExpanderStyle}"
                                              Header="{x:Static midi:Translate.UtauSettings}"
                                              IsExpanded="{Binding IsUtauSettingsExpanded, Mode=TwoWay}">
                                        <GroupBox Style="{StaticResource GroupBoxStyle}"
                                                  BorderThickness="0"
                                                  Padding="5"
                                                  IsEnabled="{Binding IsUtauModelSelected}">
                                            <StackPanel>
                                                <TextBlock Text="{x:Static midi:Translate.UtauModelName}"
                                                           Style="{StaticResource HeaderTextBlockStyle}"
                                                           Margin="0,10,0,5" />
                                                <StackPanel Orientation="Horizontal"
                                                            Margin="0,0,0,10">
                                                    <ComboBox ItemsSource="{Binding AvailableUtauVoices}"
                                                              SelectedItem="{Binding SelectedUtauVoice}"
                                                              Style="{StaticResource UtauVoiceComboBoxStyle}"
                                                              Height="32"
                                                              VerticalAlignment="Center"
                                                              VerticalContentAlignment="Center"
                                                              Margin="0,0,5,0"
                                                              MinWidth="200"
                                                              MaxDropDownHeight="300"
                                                              ScrollViewer.CanContentScroll="True"
                                                              VirtualizingPanel.IsVirtualizing="True"
                                                              VirtualizingPanel.VirtualizationMode="Recycling" />
                                                    <Button Command="{Binding RefreshUtauVoicesCommand}"
                                                            ToolTip="{x:Static midi:Translate.RefreshUtauVoices}"
                                                            Style="{StaticResource CompactButtonStyle}"
                                                            Margin="5,0,0,0"
                                                            VerticalAlignment="Center">
                                                        <Path Data="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"
                                                              Style="{StaticResource IconPathStyle}" />
                                                    </Button>
                                                </StackPanel>

                                                <Grid MinHeight="150">
                                                    <ListBox ItemsSource="{Binding AvailableUtauVoices}"
                                                             SelectedItem="{Binding SelectedUtauVoice, Mode=TwoWay}"
                                                             ItemTemplate="{StaticResource UtauVoiceDataTemplate}"
                                                             Style="{StaticResource {x:Type ListBox}}"
                                                             BorderThickness="0"
                                                             MinHeight="150"
                                                             HorizontalContentAlignment="Stretch"
                                                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                                             VirtualizingPanel.IsVirtualizing="True"
                                                             VirtualizingPanel.VirtualizationMode="Recycling"
                                                             ScrollViewer.CanContentScroll="True" />
                                                    <Border Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                                            Opacity="0.8"
                                                            Visibility="{Binding IsLoadingUtauVoices, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                        <TextBlock Text="{x:Static midi:Translate.Loading}"
                                                                   HorizontalAlignment="Center"
                                                                   VerticalAlignment="Center"
                                                                   FontSize="16"
                                                                   Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                                    </Border>
                                                </Grid>
                                            </StackPanel>
                                        </GroupBox>
                                    </Expander>

                                </StackPanel>
                            </ScrollViewer>
                        </Border>
                    </Grid>
                </TabItem>
                <TabItem Header="{x:Static midi:Translate.NoteVoiceSettingsModelManagementTab}">
                    <Grid Margin="0,10,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0"
                                   Text="{x:Static midi:Translate.NoteVoiceSettingsModelManagementHeader}"
                                   Style="{StaticResource HeaderTextBlockStyle}" />

                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <ListBox Grid.Column="0"
                                     ItemsSource="{Binding VoiceModels}"
                                     SelectedItem="{Binding SelectedModel, Mode=TwoWay}"
                                     Margin="0,0,10,0"
                                     Style="{StaticResource {x:Type ListBox}}"
                                     DisplayMemberPath="Name" />
                            <StackPanel Grid.Column="1"
                                        VerticalAlignment="Top">
                                <Button Content="{x:Static midi:Translate.NoteVoiceSettingsNewButton}"
                                        Command="{Binding CreateNewModelCommand}"
                                        Style="{StaticResource RichButtonStyle}"
                                        Margin="0,0,0,5" />
                                <Button Content="{x:Static midi:Translate.NoteVoiceSettingsRenameButton}"
                                        Command="{Binding EditModelNameCommand}"
                                        IsEnabled="{Binding CanEditModelName}"
                                        Style="{StaticResource RichButtonStyle}"
                                        Margin="0,0,0,5" />
                                <Button Content="{x:Static midi:Translate.NoteVoiceSettingsDeleteButton}"
                                        Command="{Binding DeleteModelCommand}"
                                        IsEnabled="{Binding CanDeleteModel}"
                                        Style="{StaticResource RichButtonStyle}" />
                            </StackPanel>
                        </Grid>
                    </Grid>
                </TabItem>
            </TabControl>
        </DockPanel>
    </Grid>
</UserControl>